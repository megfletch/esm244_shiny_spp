---
title: "shinyapp"
author: "Danielle Sclafani"
date: "2/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(janitor)
library(sf)
library(tmap)
library(sp)
library(rnaturalearthdata)
library(rgeos)
```


```{r}
# reading in the data
parks_data <- read_csv(here("data", "parks.csv")) %>% 
  clean_names() %>% 
  filter(state %in% c("CA", "CA, NV"))


species_data <- read_csv(here("data", "species.csv")) %>% 
  clean_names() %>% 
  filter(park_name %in% c("Channel Islands National Park", "Death Valley National Park", "Joshua Tree National Park", "Lassen Volcanic National Park", "Pinnacles National Park", "Redwood National Park", "Sequoia and Kings National Park", "Yosemite National Park")) %>% 
  mutate(common_names = tolower(common_names))

species_category_all <- species_data %>% 
      group_by(park_name, category) %>% 
      count()
```

```{r}
# widget 1 - CA parks radio button -> map images and summary appear

```

```{r}
# widget 2
park_boundaries <- 
  sf::read_sf(
    here("data", 
         "ne_10m_parks_and_protected_lands" ,
         "ne_10m_parks_and_protected_lands_area.shp")
  ) %>% 
  clean_names()

region_select <- park_boundaries %>% 
  filter(nps_region %in% c(input$selected_region))
```


```{r}
tmap_mode("view")

tm_shape(alaska) +
  tm_polygons(aes(color = "lightgreen"))
```




```{r}
# widget 3
species_category <- species_data %>% 
  group_by(park_name, category) %>% 
  count()


ggplot(data = species_category, aes(x = park_name, y = n, fill = category)) +
  geom_col() +
  facet_wrap(~category, scales = "free")
```








